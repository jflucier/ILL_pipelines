# build new image using this command: singularity build --force --fakeroot concoct.1.1.0.sif concoct.1.1.0.def

BootStrap: localimage
From: metawrap.1.3.sif

%setup
    # needed to copy compilation result from ip29 back to container image. Compiling inside image doesnt work
    #cp -r /home/jflucier/app/taxator-tk-1.5.0 ${SINGULARITY_ROOTFS}/

%files
    # needed to copy compilation result from ip29 back to container image. Compiling inside image doesnt work
    #/home/jflucier/app/taxator-tk-1.5.0 /

%environment
    # export PATH=/taxator-tk-1.5.0/core/bin:$PATH
    export GTDBTK_DATA_PATH=/GTDB
%post
    conda init bash
    . /miniconda3/etc/profile.d/conda.sh
    # conda activate metawrap-env

    # apt-get -y install cmake zlib1g-dev

    # rm -fr /taxator-tk_1.5.0e-64bit
    # rm -f taxator-tk_1.5.0e-64bit.tar.bz2
    # cd /
    # wget https://github.com/fungs/taxator-tk/archive/refs/tags/v1.5.0.tar.gz
    # mv v1.5.0.tar.gz taxator-tk_1.5.0.source.tar.gz
    # tar -xvzf taxator-tk_1.5.0.source.tar.gz
    # cd /taxator-tk-1.5.0/core/
    # sh build.sh
    mamba create -y --name gtdbtk-env python=3
    conda activate gtdbtk-env
    conda install -y gtdbtk=2.1.0
