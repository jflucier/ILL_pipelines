# build new image using this command: singularity build --force --fakeroot concoct.1.1.0.sif concoct.1.1.0.def

BootStrap: localimage
From: metawrap.1.3.sif

%setup


%environment
    #export PATH=/CONCOCT-1.1.0/bin:$PATH

%post
    conda init bash
    . /miniconda3/etc/profile.d/conda.sh
    conda activate metawrap-env

    apt-get update && apt-get -y upgrade
    export DEBIAN_FRONTEND=noninteractive
    apt-get -yq install libmkl-rt

    # conda update mkl concoct

    # conda install -y blas=2.5=mkl
    # mamba install -y intel-openmp
    # mamba install -y intel-openmp
    # cd /
    # wget https://github.com/BinPro/CONCOCT/archive/refs/tags/1.1.0.tar.gz
    # tar -xvzf 1.1.0.tar.gz
    # cd CONCOCT-1.1.0
    #
    # pip install -r requirements.txt
    # pip install numpy==1.18.5 python-dateutil==2.8.1
    # pip install numpy

    # python3 setup.py install
