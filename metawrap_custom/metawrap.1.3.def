# build new image using this command: singularity build --force --fakeroot concoct.1.1.0.sif concoct.1.1.0.def

BootStrap: localimage
From: /home/jflucier/localhost/projet/ILL_pipelines/metawrap_custom/metawrap.1.3.os.sif

%setup

%environment
    # export PATH=/metaWRAP/bin:${PATH}
    #export SINGULARITY_SHELL=/bin/bash
    # export DEBIAN_FRONTEND=noninteractive
    # export TZ=America/New_York
%post
    # conda init bash
    conda init bash
    . /miniconda3/etc/profile.d/conda.sh
    conda create -y --name metawrap-env python=2.7
    conda activate metawrap-env
    conda install -y samtools=1.9
    # . /miniconda3/etc/profile.d/conda.sh
    #
    # # mamba create -y --name metawrap-env python=2.7
    # conda activate metawrap-env
    # mamba install -y blas=2.5 mkl
    # mamba install -y biopython
    # mamba install -y blas=2.5
    # mamba install -y blast=2.6.0
    # mamba install -y bmtagger
    # mamba install -y bowtie2
    # mamba install -y bwa
    # mamba install -y checkm-genome
    # mamba install -y fastqc
    # mamba install -y kraken=1.1
    # mamba install -y kraken2
    # mamba install -y krona=2.7
    # mamba install -y matplotlib
    # mamba install -y maxbin2
    # mamba install -y megahit
    # mamba install -y metabat2
    # mamba install -y pandas
    # mamba install -y prokka
    # mamba install -y quast
    # mamba install -y libnghttp2
    # mamba install -y openssl
    # mamba install -y krb5
    # mamba install -y r-ggplot2
    # mamba install -y r-recommended
    # mamba install -y salmon
    # mamba install -y samtools=1.9
    # mamba install -y seaborn
    # mamba install -y spades
    # mamba install -y trim-galore
    # mamba install -y metawrap-mg=1.3.2


    # conda install -y blas=2.5=mkl

    # intall metawrap
    # cd /

    # git clone https://github.com/bxlab/metaWRAP.git
    # conda create -y -n metawrap-env python=2.7
    # conda activate metawrap-env
    #
    # conda config --file /.condarc --add channels bioconda
    # conda config --file /.condarc --add channels ursky
    #
    # cd /metaWRAP
    # conda-build .
    # mamba install -y -c bioconda bcftools
    # mamba install -c conda-forge boost
    # mamba install -y -c bioconda blast

    # mamba install --only-deps -c ursky metawrap-mg==1.3.0--hdfd78af_0

%runscript
    . "/miniconda3/etc/profile.d/conda.sh"
    conda activate metawrap-env
    $@;;
